(function(a){var d,j,l=0,m=a('<div class="colorPicker-picker">&nbsp;</div>'),n=a('<div id="colorPicker_palette" class="colorPicker-palette" />'),o=a('<div class="colorPicker-swatch">&nbsp;</div>'),p=a('<label for="colorPicker_hex">Hex</label>'),q=a('<input type="text" id="colorPicker_hex" />'),f;a.fn.colorPicker=function(b){return this.each(function(){var c=a(this),e=a.extend({},a.fn.colorPicker.defaults,b),d=a.fn.colorPicker.toHex(0<c.val().length?c.val():e.pickerDefault),k=m.clone(),g=n.clone().attr("id",
"colorPicker_palette-"+l),f=p.clone(),h=q.clone(),j=g[0].id,i;a.each(e.colors,function(b){i=o.clone();"transparent"===e.colors[b]?(i.addClass("transparent").text("X"),a.fn.colorPicker.bindPalette(h,i,"transparent")):(i.css("background-color","#"+this),a.fn.colorPicker.bindPalette(h,i));i.appendTo(g)});f.attr("for","colorPicker_hex-"+l);h.attr({id:"colorPicker_hex-"+l,value:d});h.bind("keydown",function(b){if(13===b.keyCode){var d=a.fn.colorPicker.toHex(a(this).val());a.fn.colorPicker.changeColor(d?
d:c.val())}27===b.keyCode&&a.fn.colorPicker.hidePalette()});h.bind("keyup",function(b){b=a.fn.colorPicker.toHex(a(b.target).val());a.fn.colorPicker.previewColor(b?b:c.val())});a('<div class="colorPicker_hexWrap" />').append(f).appendTo(g);g.find(".colorPicker_hexWrap").append(h);a("body").append(g);g.hide();k.css("background-color",d);k.bind("click",function(){a.fn.colorPicker.togglePalette(a("#"+j),a(this))});b&&b.onColorChange?k.data("onColorChange",b.onColorChange):k.data("onColorChange",function(){});
c.after(k);c.bind("change",function(){c.next(".colorPicker-picker").css("background-color",a.fn.colorPicker.toHex(a(this).val()))});c.val(d).hide();l++})};a.extend(!0,a.fn.colorPicker,{toHex:function(a){if(a.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i))return a.charAt(0)==="#"?a:"#"+a;if(a.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/)){var c=[parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)],d=function(a){if(a.length<2)for(var b=0,c=2-a.length;b<c;b++)a="0"+a;return a};
if(c.length===3){var a=d(c[0].toString(16)),f=d(c[1].toString(16)),c=d(c[2].toString(16));return"#"+a+f+c}}else return false},checkMouse:function(b){var c=j,e=a(b.target).parents("#"+c.attr("id")).length;b.target===a(c)[0]||(b.target===d[0]||e>0)||a.fn.colorPicker.hidePalette()},hidePalette:function(){a(document).unbind("mousedown",a.fn.colorPicker.checkMouse);a(".colorPicker-palette").hide()},showPalette:function(b){var c=d.prev("input").val();b.css({top:d.offset().top+d.outerHeight(),left:d.offset().left});
a("#color_value").val(c);b.show();a(document).bind("mousedown",a.fn.colorPicker.checkMouse)},togglePalette:function(b,c){c&&(d=c);j=b;j.is(":visible")?a.fn.colorPicker.hidePalette():a.fn.colorPicker.showPalette(b)},changeColor:function(b){d.css("background-color",b);d.prev("input").val(b).change();a.fn.colorPicker.hidePalette();d.data("onColorChange").call(d,a(d).prev("input").attr("id"),b)},previewColor:function(a){d.css("background-color",a)},bindPalette:function(b,c,e){e=e?e:a.fn.colorPicker.toHex(c.css("background-color"));
c.bind({click:function(){f=e;a.fn.colorPicker.changeColor(e)},mouseover:function(){f=b.val();a(this).css("border-color","#598FEF");b.val(e);a.fn.colorPicker.previewColor(e)},mouseout:function(){a(this).css("border-color","#000");b.val(d.css("background-color"));b.val(f);a.fn.colorPicker.previewColor(f)}})}});a.fn.colorPicker.defaults={pickerDefault:"FFFFFF",colors:"000000 993300 333300 000080 333399 333333 800000 FF6600 808000 008000 008080 0000FF 666699 808080 FF0000 FF9900 99CC00 339966 33CCCC 3366FF 800080 999999 FF00FF FFCC00 FFFF00 00FF00 00FFFF 00CCFF 993366 C0C0C0 FF99CC FFCC99 FFFF99 CCFFFF 99CCFF FFFFFF".split(" "),
addColors:[]}})(jQuery);
